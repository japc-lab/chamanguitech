<!-- begin::Header -->
<div class="card-header border-0 pt-8">
  <h4 class="card-title align-items-start flex-column">
    <span class="card-label fw-bolder fs-3 mb-1">{{ title }}</span>
  </h4>
</div>
<!-- end::Header -->

<!-- begin::Body -->
<div class="card-body py-3">
  <!-- begin::Table container -->
  <div class="table-responsive">
    <!-- begin::Table -->
    <table class="table table-row-bordered table-row-gray-100 align-middle gs-0 gy-3">
      <!-- begin::Table head -->
      <thead>
        <tr class="fw-bold text-muted bg-light-primary">
          <th class="ps-4 min-w-200px rounded-start" translate="LOGISTICS.PAYMENTS.TABLE.DESCRIPTION"></th>
          <th class="min-w-120px text-end" translate="LOGISTICS.PAYMENTS.TABLE.AMOUNT"></th>
          <th class="min-w-120px text-center" translate="LOGISTICS.PAYMENTS.TABLE.PAYMENT_STATUS"></th>
          <th class="min-w-120px text-center" translate="LOGISTICS.PAYMENTS.TABLE.PAYMENT_DATE"></th>
          <th class="min-w-150px text-center" translate="LOGISTICS.PAYMENTS.TABLE.PAYMENT_METHOD"></th>
          <th class="min-w-120px text-center" translate="LOGISTICS.PAYMENTS.TABLE.HAS_INVOICE"></th>
          <th class="min-w-150px text-center" translate="LOGISTICS.PAYMENTS.TABLE.INVOICE_NUMBER"></th>
          <th class="min-w-150px text-center" translate="LOGISTICS.PAYMENTS.TABLE.INVOICE_NAME"></th>
          <th class="min-w-150px text-center" translate="LOGISTICS.PAYMENTS.TABLE.PERSON_IN_CHARGE"></th>
          <th class="min-w-120px text-center" translate="LOGISTICS.PAYMENTS.TABLE.COMPLETE_INFO"></th>
          <th class="min-w-200px text-center rounded-end" translate="LOGISTICS.PAYMENTS.TABLE.OBSERVATIONS"></th>
        </tr>
      </thead>
      <!-- end::Table head -->

      <!-- begin::Table body -->
      <tbody>
        <!-- Logistics Payment rows -->
        <ng-container *ngFor="let payment of logisticsPayments; let i = index">
          <tr [class.table-light]="payment.isCompleted"
            [class.border-success]="payment.isCompleted">

            <!-- Description -->
            <td class="ps-4">
              <div class="d-flex align-items-center">
                <div class="d-flex justify-content-start flex-column">
                  <span class="text-dark fw-bold text-h6 mb-1">{{ getDescriptionForCategory(payment.financeCategory) }}</span>
                </div>
              </div>
            </td>

            <!-- Amount -->
            <td class="text-end">
              <div class="input-group input-group-sm">
                <span class="input-group-text">$</span>
                <input type="number" class="form-control text-end no-spinner" [value]="payment.amount" readonly
                  placeholder="0.00" />
              </div>
            </td>

            <!-- Payment Status -->
            <td class="text-center">
              <select class="form-select form-select-sm" [(ngModel)]="payment.paymentStatus"
                (ngModelChange)="onPaymentStatusChange(payment, $event)">
                <option *ngFor="let status of paymentStatuses" [value]="status.value">
                  {{ status.label }}
                </option>
              </select>
            </td>

            <!-- Payment Date -->
            <td class="text-center">
              <input type="date" class="form-control form-control-sm" [(ngModel)]="payment.paymentDate"
                (ngModelChange)="onPaymentDateChange(payment, $event)" [disabled]="payment.paymentStatus !== 'PAID'"
                [class.is-invalid]="showValidationErrors && !isPaymentDateValid(payment)" />
              <div *ngIf="showValidationErrors && !isPaymentDateValid(payment)" class="invalid-feedback d-block small">
                {{ 'LOGISTICS.VALIDATIONS.PAYMENT_DATE_REQUIRED' | translate }}
              </div>
            </td>

            <!-- Payment Method -->
            <td class="text-center">
              <select class="form-select form-select-sm" [(ngModel)]="payment.paymentMethod"
                (ngModelChange)="onPaymentMethodChange(payment, $event)" [disabled]="payment.paymentStatus !== 'PAID'"
                [class.is-invalid]="showValidationErrors && !isPaymentMethodValid(payment)">
                <option value="">{{ 'LOGISTICS.PLACEHOLDERS.SELECT_OPTION' | translate }}</option>
                <option *ngFor="let method of paymentMethods" [ngValue]="method">
                  {{ method.name }}
                </option>
              </select>
              <div *ngIf="showValidationErrors && !isPaymentMethodValid(payment)" class="invalid-feedback d-block small">
                {{ 'LOGISTICS.VALIDATIONS.PAYMENT_METHOD_REQUIRED' | translate }}
              </div>
            </td>

            <!-- Has Invoice -->
            <td class="text-center">
              <select class="form-select form-select-sm" [(ngModel)]="payment.hasInvoice"
                (ngModelChange)="onHasInvoiceChange(payment, $event)" [disabled]="payment.paymentStatus !== 'PAID'">
                <option *ngFor="let option of invoiceOptions" [value]="option.value">
                  {{ option.label }}
                </option>
              </select>
            </td>

            <!-- Invoice Number -->
            <td class="text-center">
              <input type="text" class="form-control form-control-sm" [(ngModel)]="payment.invoiceNumber"
                (ngModelChange)="onInvoiceNumberChange(payment, $event)"
                [placeholder]="'LOGISTICS.PLACEHOLDERS.NUMBER' | translate"
                [disabled]="payment.hasInvoice !== 'yes'"
                [class.is-invalid]="showValidationErrors && !isInvoiceNumberValid(payment)" />
              <div *ngIf="showValidationErrors && !isInvoiceNumberValid(payment)" class="invalid-feedback d-block small">
                {{ 'LOGISTICS.VALIDATIONS.INVOICE_NUMBER_REQUIRED' | translate }}
              </div>
            </td>

            <!-- Invoice Name -->
            <td class="text-center">
              <input type="text" class="form-control form-control-sm" [(ngModel)]="payment.invoiceName"
                (ngModelChange)="onInvoiceNameChange(payment, $event)"
                [placeholder]="'LOGISTICS.PLACEHOLDERS.NAME' | translate"
                [disabled]="payment.hasInvoice !== 'yes'"
                [class.is-invalid]="showValidationErrors && !isInvoiceNameValid(payment)" />
              <div *ngIf="showValidationErrors && !isInvoiceNameValid(payment)" class="invalid-feedback d-block small">
                {{ 'LOGISTICS.VALIDATIONS.INVOICE_NAME_REQUIRED' | translate }}
              </div>
            </td>

            <!-- Person in Charge -->
            <td class="text-center">
              <input type="text" class="form-control form-control-sm" [(ngModel)]="payment.personInCharge"
                (ngModelChange)="onPersonInChargeChange(payment, $event)"
                [placeholder]="'LOGISTICS.PLACEHOLDERS.NAME' | translate"
                [disabled]="payment.paymentStatus !== 'PAID'"
                [class.is-invalid]="showValidationErrors && !isPersonInChargeValid(payment)" />
              <div *ngIf="showValidationErrors && !isPersonInChargeValid(payment)" class="invalid-feedback d-block small">
                {{ 'LOGISTICS.VALIDATIONS.PERSON_IN_CHARGE_REQUIRED' | translate }}
              </div>
            </td>

            <!-- Complete Information -->
            <td class="text-center">
              <span *ngIf="payment.isCompleted" class="badge badge-light-success">
                <i class="fas fa-check-circle me-1"></i><span translate="LOGISTICS.PAYMENTS.COMPLETE_STATUS.COMPLETE"></span>
              </span>
              <span *ngIf="!payment.isCompleted" class="badge badge-light-warning">
                <i class="fas fa-exclamation-circle me-1"></i><span translate="LOGISTICS.PAYMENTS.COMPLETE_STATUS.INCOMPLETE"></span>
              </span>
            </td>

            <!-- Observations -->
            <td class="text-center">
              <input type="text" class="form-control form-control-sm" [(ngModel)]="payment.observation"
                (ngModelChange)="onObservationChange(payment, $event)"
                [placeholder]="'LOGISTICS.PLACEHOLDERS.COMMENTS' | translate" />
            </td>
          </tr>
        </ng-container>

        <!-- Total General Logistics Row -->
        <tr class="table-light border-top border-primary" *ngIf="logisticsPayments.length > 0">
          <td class="ps-4 fw-bold fs-5" translate="LOGISTICS.PAYMENTS.TOTAL_GENERAL_LOGISTICS"></td>
          <td class="text-end fw-bold fs-5">$ {{ getTotalAmount() | number: '1.2-2' }}</td>
          <td class="text-center">
            <span class="badge" [class.badge-light-success]="getOverallPaymentStatus() === 'PAID'"
              [class.badge-light-warning]="getOverallPaymentStatus() === 'PENDING'"
              [class.badge-light-secondary]="getOverallPaymentStatus() === 'NO_PAYMENT'">
              {{ getOverallPaymentStatusLabel() }}
            </span>
          </td>
          <td colspan="8"></td>
        </tr>
        <!-- end::Table body -->
    </table>
    <!-- end::Table -->
  </div>
  <!-- end::Table container -->
</div>
<!-- end::Body -->
